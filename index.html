<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emby & Arby Meal Planner</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase SDKs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-storage-compat.min.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif; }
        .file-drop-zone {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .file-drop-zone:hover,
        .file-drop-zone.dragover {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .file-preview {
            max-width: 100%;
            max-height: 150px;
            border-radius: 8px;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // ===== FIREBASE CONFIGURATION =====
        // Replace these values with your Firebase project configuration
        const firebaseConfig = {
        apiKey: "AIzaSyAeNU_prYg4OwnJs4gNrsKXS-NIae9KE6g",
        authDomain: "meal-planner-a5e0e.firebaseapp.com",
        databaseURL: "https://meal-planner-a5e0e-default-rtdb.firebaseio.com",
        projectId: "meal-planner-a5e0e",
        storageBucket: "meal-planner-a5e0e.firebasestorage.app",
        messagingSenderId: "416117855023",
        appId: "1:416117855023:web:eb8d3abcff2e4cf01487da",
        measurementId: "G-Q5GETBGNGX"
        };

        // Initialize Firebase
        let db = null;
        let isFirebaseConfigured = false;

        try {
            if (firebaseConfig.apiKey !== "YOUR_API_KEY_HERE") {
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                isFirebaseConfigured = true;
                console.log("Firebase initialized successfully");
            } else {
                console.log("Firebase not configured - using local storage only");
            }
        } catch (error) {
            console.error("Firebase initialization error:", error);
        }
        
        // Icon components
        const Plus = () => React.createElement('span', {}, '+');
        const X = ({ size }) => React.createElement('span', { style: { fontSize: size ? `${size}px` : '14px' }}, 'Ã—');
        const Shuffle = ({ size }) => React.createElement('span', { style: { fontSize: size ? `${size}px` : '16px' }}, 'ðŸŽ²');
        const Upload = ({ size }) => React.createElement('span', { style: { fontSize: size ? `${size}px` : '16px' }}, 'ðŸ“');
        
        const ChefHat = () => React.createElement('svg', {
            width: '36',
            height: '36',
            viewBox: '0 0 24 24',
            fill: 'none',
            stroke: 'currentColor',
            strokeWidth: '2',
            strokeLinecap: 'round',
            strokeLinejoin: 'round',
            className: 'text-gray-600'
        },
            React.createElement('path', { d: 'M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z' }),
            React.createElement('line', { x1: '6', y1: '17', x2: '18', y2: '17' })
        );
        
        const Calendar = () => React.createElement('svg', {
            width: '20',
            height: '20',
            viewBox: '0 0 24 24',
            fill: 'none',
            stroke: 'currentColor',
            strokeWidth: '2',
            strokeLinecap: 'round',
            strokeLinejoin: 'round',
            className: 'text-gray-600'
        },
            React.createElement('rect', { x: '3', y: '4', width: '18', height: '18', rx: '2', ry: '2' }),
            React.createElement('line', { x1: '16', y1: '2', x2: '16', y2: '6' }),
            React.createElement('line', { x1: '8', y1: '2', x2: '8', y2: '6' }),
            React.createElement('line', { x1: '3', y1: '10', x2: '21', y2: '10' })
        );

        const Cloud = () => React.createElement('svg', {
            width: '16',
            height: '16',
            viewBox: '0 0 24 24',
            fill: 'none',
            stroke: 'currentColor',
            strokeWidth: '2',
            strokeLinecap: 'round',
            strokeLinejoin: 'round'
        },
            React.createElement('path', { d: 'M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z' })
        );

        const MealPlannerApp = () => {
            const [meals, setMeals] = useState([
                {
                    id: 1,
                    name: "Spaghetti Carbonara",
                    ingredients: ["pasta", "eggs", "bacon", "parmesan", "black pepper"],
                    image: "https://images.unsplash.com/photo-1621996346565-e3dbc353d2e5?w=400&h=300&fit=crop&auto=format"
                },
                {
                    id: 2,
                    name: "Chicken Stir Fry",
                    ingredients: ["chicken breast", "mixed vegetables", "soy sauce", "garlic", "ginger", "rice"],
                    image: "https://images.unsplash.com/photo-1603133872878-684f208fb84b?w=400&h=300&fit=crop&auto=format"
                },
                {
                    id: 3,
                    name: "Vegetable Curry",
                    ingredients: ["mixed vegetables", "coconut milk", "curry powder", "onion", "garlic", "rice"],
                    image: "https://images.unsplash.com/photo-1565557623262-b51c2513a641?w=400&h=300&fit=crop&auto=format"
                }
            ]);

            const [weeklyPlan, setWeeklyPlan] = useState({
                Monday: null,
                Tuesday: null,
                Wednesday: null,
                Thursday: null,
                Friday: null,
                Saturday: null,
                Sunday: null
            });

            const [showAddMeal, setShowAddMeal] = useState(false);
            const [newMealName, setNewMealName] = useState('');
            const [newMealIngredients, setNewMealIngredients] = useState('');
            const [newMealImage, setNewMealImage] = useState('');
            const [imagePreview, setImagePreview] = useState('');
            const [uploadMethod, setUploadMethod] = useState('url'); // 'url' or 'upload'
            const [saving, setSaving] = useState(false);
            const [lastSaved, setLastSaved] = useState(null);
            
            const fileInputRef = useRef(null);

            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

            // Load data from Firebase on component mount
            useEffect(() => {
                if (isFirebaseConfigured) {
                    loadFromFirebase();
                }
            }, []);

            // Save data to Firebase
            const saveToFirebase = async () => {
                if (!isFirebaseConfigured) {
                    alert("Firebase not configured. Please add your Firebase configuration to enable cloud saving.");
                    return;
                }

                setSaving(true);
                try {
                    const dataToSave = {
                        meals: meals,
                        weeklyPlan: weeklyPlan,
                        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                    };

                    await db.collection('mealPlans').doc('emby-arby-plan').set(dataToSave);
                    setLastSaved(new Date());
                    console.log("Data saved to Firebase successfully");
                } catch (error) {
                    console.error("Error saving to Firebase:", error);
                    alert("Failed to save data. Please check your internet connection and Firebase configuration.");
                } finally {
                    setSaving(false);
                }
            };

            // Load data from Firebase
            const loadFromFirebase = async () => {
                if (!isFirebaseConfigured) return;

                try {
                    const doc = await db.collection('mealPlans').doc('emby-arby-plan').get();
                    if (doc.exists) {
                        const data = doc.data();
                        if (data.meals) setMeals(data.meals);
                        if (data.weeklyPlan) setWeeklyPlan(data.weeklyPlan);
                        setLastSaved(data.lastUpdated?.toDate() || new Date());
                        console.log("Data loaded from Firebase successfully");
                    }
                } catch (error) {
                    console.error("Error loading from Firebase:", error);
                }
            };

            // Auto-save when meals or weekly plan changes
            useEffect(() => {
                if (isFirebaseConfigured && (meals.length > 0 || Object.values(weeklyPlan).some(meal => meal !== null))) {
                    const timeoutId = setTimeout(() => {
                        saveToFirebase();
                    }, 2000); // Auto-save after 2 seconds of inactivity

                    return () => clearTimeout(timeoutId);
                }
            }, [meals, weeklyPlan]);

            // Handle file upload
            const handleFileUpload = async (file) => {
                if (!isFirebaseConfigured) {
                    alert("Firebase not configured. Please add your Firebase configuration to enable image uploads.");
                    return;
                }

                if (file && file.type.startsWith('image/')) {
                    try {
                        // Create unique filename
                        const timestamp = Date.now();
                        const randomId = Math.random().toString(36).substr(2, 9);
                        const fileName = `${timestamp}_${randomId}_${file.name}`;
                        
                        const storageRef = firebase.storage().ref();
                        const fileRef = storageRef.child(`meals/${fileName}`);

                        // Show local preview while uploading
                        const localPreview = URL.createObjectURL(file);
                        setImagePreview(localPreview);

                        // Upload to Firebase Storage
                        const uploadTask = await fileRef.put(file);
                        
                        // Get the download URL
                        const downloadURL = await fileRef.getDownloadURL();
                        
                        console.log("Upload successful, URL:", downloadURL); // Debug log

                        // Update both states with the Firebase URL
                        setNewMealImage(downloadURL);
                        setImagePreview(downloadURL);

                        // Clean up local preview
                        URL.revokeObjectURL(localPreview);

                    } catch (error) {
                        console.error("Error uploading file:", error);
                        alert("Image upload failed: " + error.message);
                    }
                } else {
                    alert('Please select a valid image file.');
                }
            };

            // 2. Fixed addMeal function 
const addMeal = () => {
    if (newMealName.trim() && newMealIngredients.trim()) {
        const ingredientsList = newMealIngredients.split(',').map(ing => ing.trim());
        
        console.log("Current newMealImage state:", newMealImage);
        console.log("Current uploadMethod:", uploadMethod);
        console.log("Current imagePreview:", imagePreview);
        
        // Use newMealImage for both upload and URL methods
        // newMealImage contains the Firebase Storage URL after upload
        let imageUrl = newMealImage.trim() || "https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=400&h=300&fit=crop&auto=format";
        
        console.log("Final image URL being used:", imageUrl);
        
        const newMeal = {
            id: Date.now(),
            name: newMealName.trim(),
            ingredients: ingredientsList,
            image: imageUrl
        };
        
        setMeals([...meals, newMeal]);
        
        // Reset form
        setNewMealName('');
        setNewMealIngredients('');
        setNewMealImage('');
        setImagePreview('');
        setUploadMethod('url');
        setShowAddMeal(false);
    }
};

            // Handle drag and drop
            const handleDragOver = (e) => {
                e.preventDefault();
                e.currentTarget.classList.add('dragover');
            };

            const handleDragLeave = (e) => {
                e.preventDefault();
                e.currentTarget.classList.remove('dragover');
            };

            const handleDrop = (e) => {
                e.preventDefault();
                e.currentTarget.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload(files[0]);
                }
            };

            // Get current week dates
            const getCurrentWeekDates = () => {
                const today = new Date();
                const currentDay = today.getDay();
                const monday = new Date(today);
                monday.setDate(today.getDate() - (currentDay === 0 ? 6 : currentDay - 1));
                
                const weekDates = [];
                for (let i = 0; i < 7; i++) {
                    const date = new Date(monday);
                    date.setDate(monday.getDate() + i);
                    weekDates.push(date);
                }
                return weekDates;
            };

            const formatDate = (date) => {
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                return `${months[date.getMonth()]} ${date.getDate()}`;
            };

            const getWeekRange = () => {
                const dates = getCurrentWeekDates();
                const startDate = formatDate(dates[0]);
                const endDate = formatDate(dates[6]);
                return `Week of ${startDate} - ${endDate}`;
            };

            const deleteMeal = async (mealId) => {
                const mealToDelete = meals.find(meal => meal.id === mealId);

                // If there's an image in Firebase Storage (URL contains "firebasestorage.googleapis.com"), delete it
                if (isFirebaseConfigured && mealToDelete?.image && mealToDelete.image.includes("firebasestorage.googleapis.com")) {
                    try {
                        // Create a reference to the file from the URL
                        const storageRef = firebase.storage().refFromURL(mealToDelete.image);
                        await storageRef.delete();
                        console.log("Deleted image from Firebase Storage:", mealToDelete.image);
                    } catch (error) {
                        console.error("Error deleting image from Firebase Storage:", error);
                    }
                }

                // Remove meal from the list
                setMeals(meals.filter(meal => meal.id !== mealId));

                // Remove from weekly plan
                const updatedPlan = { ...weeklyPlan };
                Object.keys(updatedPlan).forEach(day => {
                    if (updatedPlan[day]?.id === mealId) {
                        updatedPlan[day] = null;
                    }
                });
                setWeeklyPlan(updatedPlan);
            };

            const assignMealToDay = (day, meal) => {
                setWeeklyPlan({
                    ...weeklyPlan,
                    [day]: meal
                });
            };

            const removeMealFromDay = (day) => {
                setWeeklyPlan({
                    ...weeklyPlan,
                    [day]: null
                });
            };

            const randomizeMealPlan = () => {
                const availableMeals = [...meals];
                const newPlan = {};
                
                days.forEach(day => {
                    if (availableMeals.length > 0) {
                        const randomIndex = Math.floor(Math.random() * availableMeals.length);
                        newPlan[day] = availableMeals[randomIndex];
                    } else {
                        newPlan[day] = null;
                    }
                });
                
                setWeeklyPlan(newPlan);
            };

            const clearWeeklyPlan = () => {
                setWeeklyPlan({
                    Monday: null,
                    Tuesday: null,
                    Wednesday: null,
                    Thursday: null,
                    Friday: null,
                    Saturday: null,
                    Sunday: null
                });
            };

            const weekDates = getCurrentWeekDates();

            return React.createElement('div', { className: "min-h-screen bg-gray-50 p-4" },
                React.createElement('div', { className: "max-w-6xl mx-auto" },
                    // Header
                    React.createElement('div', { className: "text-center mb-8" },
                        React.createElement('div', { className: "flex items-center justify-center gap-4 mb-6" },
                            React.createElement('div', { className: "bg-white rounded-full p-4 shadow-sm" },
                                React.createElement(ChefHat)
                            ),
                            React.createElement('h1', { className: "text-3xl font-bold text-gray-900" }, "Emby & Arby Meal Planner")                        ),
                        React.createElement('p', { className: "text-lg text-gray-600 mb-4" }, "Health is wealth! Let's add some delicious meals for the current week."),
                        React.createElement('div', { className: "flex items-center justify-center gap-3 text-gray-600 mb-4" },
                            React.createElement(Calendar),
                            React.createElement('span', { className: "text-lg font-small" }, getWeekRange())
                        ),
                        
                        // Firebase Status & Save Button
                        React.createElement('div', { className: "flex items-center justify-center gap-4" },
                            isFirebaseConfigured ? 
                                React.createElement('div', { className: "flex items-center gap-4" },
                                    React.createElement('button', {
                                        onClick: saveToFirebase,
                                        disabled: saving,
                                        className: `flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${
                                            saving 
                                                ? 'bg-gray-400 cursor-not-allowed' 
                                                : 'bg-green-600 hover:bg-green-700'
                                        } text-white`
                                    },
                                        React.createElement(Cloud),
                                        saving ? "Saving..." : "Save to Cloud"
                                    ),
                                    lastSaved && React.createElement('span', { className: "text-sm text-gray-500" },
                                        `Last saved: ${lastSaved.toLocaleTimeString()}`
                                    ),
                                    React.createElement('div', { className: "flex items-center gap-1" },
                                        React.createElement('div', { className: "w-2 h-2 bg-green-500 rounded-full" }),
                                        React.createElement('span', { className: "text-sm text-gray-600" }, "Cloud Connected")
                                    )
                                ) :
                                React.createElement('div', { className: "flex items-center gap-4" },
                                    React.createElement('div', { className: "flex items-center gap-1" },
                                        React.createElement('div', { className: "w-2 h-2 bg-orange-500 rounded-full" }),
                                        React.createElement('span', { className: "text-sm text-gray-600" }, "Firebase Not Configured")
                                    ),
                                    React.createElement('span', { className: "text-xs text-gray-500" }, "Add your Firebase config to enable cloud saving")
                                )
                        )
                    ),

                    // Weekly Plan Section
                    React.createElement('div', { className: "bg-white rounded-xl shadow-lg p-6 mb-8" },
                        React.createElement('div', { className: "flex justify-between items-center mb-6" },
                            React.createElement('h2', { className: "text-2xl font-semibold text-gray-800" }, "This Week's Plan"),
                            React.createElement('div', { className: "flex gap-3" },
                                React.createElement('button', {
                                    onClick: randomizeMealPlan,
                                    className: "flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors"
                                },
                                    React.createElement(Shuffle, { size: 16 }),
                                    "Randomize"
                                ),
                                React.createElement('button', {
                                    onClick: clearWeeklyPlan,
                                    className: "flex items-center gap-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors"
                                }, "Clear All")
                            )
                        ),

                        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7 gap-4" },
                            days.map((day, index) =>
                                React.createElement('div', { 
                                    key: day, 
                                    className: "border-2 border-dashed border-gray-300 rounded-lg p-4 min-h-32 hover:border-blue-400 transition-colors",
                                    onDragOver: (e) => {
                                        e.preventDefault();
                                        e.currentTarget.classList.add('border-blue-500', 'bg-blue-50');
                                    },
                                    onDragLeave: (e) => {
                                        e.currentTarget.classList.remove('border-blue-500', 'bg-blue-50');
                                    },
                                    onDrop: (e) => {
                                        e.preventDefault();
                                        e.currentTarget.classList.remove('border-blue-500', 'bg-blue-50');
                                        try {
                                            const mealData = JSON.parse(e.dataTransfer.getData('application/json'));
                                            assignMealToDay(day, mealData);
                                        } catch (error) {
                                            console.log('Error dropping meal:', error);
                                        }
                                    }
                                },
                                    React.createElement('div', { className: "text-center mb-2" },
                                        React.createElement('h3', { className: "font-semibold text-gray-700" }, day),
                                        React.createElement('p', { className: "text-xs text-gray-500" }, formatDate(weekDates[index]))
                                    ),
                                    weeklyPlan[day] ? 
                                        React.createElement('div', { className: "bg-blue-50 border border-blue-200 rounded-lg p-3 relative group" },
                                            React.createElement('button', {
                                                onClick: () => removeMealFromDay(day),
                                                className: "absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"
                                            }, React.createElement(X, { size: 12 })),
                                            weeklyPlan[day].image && React.createElement('img', {
                                                src: weeklyPlan[day].image,
                                                alt: weeklyPlan[day].name,
                                                className: "w-full h-20 object-cover rounded mb-2",
                                                onError: (e) => { e.target.style.display = 'none'; }
                                            }),
                                            React.createElement('h4', { className: "font-medium text-sm text-gray-800 mb-1" }, weeklyPlan[day].name),
                                            React.createElement('p', { className: "text-xs text-gray-600" }, 
                                                weeklyPlan[day].ingredients.slice(0, 3).join(', ') + 
                                                (weeklyPlan[day].ingredients.length > 3 ? '...' : '')
                                            )
                                        ) :
                                        React.createElement('p', { className: "text-gray-400 text-sm text-center" }, "Drop a meal here")
                                )
                            )
                        )
                    ),

                    // Meals Library Section
                    React.createElement('div', { className: "bg-white rounded-xl shadow-lg p-6" },
                        React.createElement('div', { className: "flex justify-between items-center mb-6" },
                            React.createElement('h2', { className: "text-2xl font-semibold text-gray-800" }, "Meal Library"),
                            React.createElement('button', {
                                onClick: () => setShowAddMeal(true),
                                className: "flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors"
                            },
                                React.createElement(Plus, { size: 16 }),
                                "Add New Meal"
                            )
                        ),

                        // Add Meal Form
                        showAddMeal && React.createElement('div', { className: "bg-gray-50 rounded-lg p-4 mb-6" },
                            React.createElement('h3', { className: "font-semibold text-gray-700 mb-3" }, "Add New Meal"),
                            React.createElement('div', { className: "space-y-4" },
                                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                                    React.createElement('input', {
                                        type: "text",
                                        placeholder: "Meal name",
                                        value: newMealName,
                                        onChange: (e) => setNewMealName(e.target.value),
                                        className: "border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    }),
                                    React.createElement('input', {
                                        type: "text",
                                        placeholder: "Ingredients (comma separated)",
                                        value: newMealIngredients,
                                        onChange: (e) => setNewMealIngredients(e.target.value),
                                        className: "border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    })
                                ),
                                
                                // Image Upload Options
                                React.createElement('div', { className: "space-y-3" },
                                    React.createElement('div', { className: "flex gap-4" },
                                        React.createElement('label', { className: "flex items-center" },
                                            React.createElement('input', {
                                                type: "radio",
                                                name: "imageMethod",
                                                value: "url",
                                                checked: uploadMethod === 'url',
                                                onChange: (e) => {
                                                    setUploadMethod(e.target.value);
                                                    setImagePreview('');
                                                    setNewMealImage('');
                                                },
                                                className: "mr-2"
                                            }),
                                            React.createElement('span', {}, "Image URL")
                                        ),
                                        React.createElement('label', { className: "flex items-center" },
                                            React.createElement('input', {
                                                type: "radio",
                                                name: "imageMethod",
                                                value: "upload",
                                                checked: uploadMethod === 'upload',
                                                onChange: (e) => {
                                                    setUploadMethod(e.target.value);
                                                    setImagePreview('');
                                                    setNewMealImage('');
                                                },
                                                className: "mr-2"
                                            }),
                                            React.createElement('span', {}, "Upload Image")
                                        )
                                    ),

                                    uploadMethod === 'url' ? 
                                        React.createElement('input', {
                                            type: "text",
                                            placeholder: "Image URL (optional - we'll use a default if empty)",
                                            value: newMealImage,
                                            onChange: (e) => {
                                                setNewMealImage(e.target.value);
                                                setImagePreview(e.target.value);
                                            },
                                            className: "w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        }) :
                                        React.createElement('div', { className: "space-y-3" },
                                            React.createElement('div', {
                                                className: "file-drop-zone",
                                                onClick: () => fileInputRef.current?.click(),
                                                onDragOver: handleDragOver,
                                                onDragLeave: handleDragLeave,
                                                onDrop: handleDrop
                                            },
                                                React.createElement('div', { className: "space-y-2" },
                                                    React.createElement(Upload, { size: 32 }),
                                                    React.createElement('p', { className: "text-gray-600" }, "Click to upload or drag and drop"),
                                                    React.createElement('p', { className: "text-sm text-gray-500" }, "PNG, JPG, GIF up to 10MB")
                                                )
                                            ),
                                            React.createElement('input', {
                                                ref: fileInputRef,
                                                type: "file",
                                                accept: "image/*",
                                                onChange: (e) => {
                                                    if (e.target.files[0]) {
                                                        handleFileUpload(e.target.files[0]);
                                                    }
                                                },
                                                className: "hidden"
                                            })
                                        )
                                ),

                                // Image Preview
                                imagePreview && React.createElement('div', { className: "mt-3" },
                                    React.createElement('p', { className: "text-sm text-gray-600 mb-2" }, "Image Preview:"),
                                    React.createElement('img', {
                                        src: imagePreview,
                                        alt: "Preview",
                                        className: "file-preview",
                                        onError: () => setImagePreview('')
                                    })
                                ),

                                React.createElement('div', { className: "flex gap-2" },
                                    React.createElement('button', {
                                        onClick: addMeal,
                                        className: "bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors"
                                    }, "Submit"),
                                    React.createElement('button', {
                                        onClick: () => setShowAddMeal(false),
                                        className: "bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors"
                                    }, "Cancel")
                                )
                            )
                        ),

                        // Meals Grid
                        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" },
                            meals.map(meal =>
                                React.createElement('div', {
                                    key: meal.id,
                                    className: "border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-grab active:cursor-grabbing group relative",
                                    draggable: true,
                                    onDragStart: (e) => {
                                        e.dataTransfer.setData('application/json', JSON.stringify(meal));
                                        e.dataTransfer.effectAllowed = 'copy';
                                        e.currentTarget.style.opacity = '0.5';
                                    },
                                    onDragEnd: (e) => {
                                        e.currentTarget.style.opacity = '1';
                                    }
                                },
                                    React.createElement('button', {
                                        onClick: () => deleteMeal(meal.id),
                                        className: "absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10"
                                    }, React.createElement(X, { size: 14 })),
                                    
                                    meal.image && React.createElement('img', {
                                        src: meal.image,
                                        alt: meal.name,
                                        className: "w-full h-32 object-cover rounded-lg mb-3",
                                        onError: (e) => { e.target.style.display = 'none'; }
                                    }),
                                    
                                    React.createElement('h3', { className: "font-semibold text-gray-800 mb-2 pr-8" }, meal.name),
                                    React.createElement('div', { className: "flex flex-wrap gap-1 mb-3" },
                                        meal.ingredients.slice(0, 4).map((ingredient, index) =>
                                            React.createElement('span', {
                                                key: index,
                                                className: "bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded-full"
                                            }, ingredient)
                                        ),
                                        meal.ingredients.length > 4 && React.createElement('span', {
                                            className: "bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded-full"
                                        }, `+${meal.ingredients.length - 4} more`)
                                    ),
                                    
                                    // React.createElement('div', { className: "flex gap-2" },
                                    //     days.map(day =>
                                    //         React.createElement('button', {
                                    //             key: day,
                                    //             onClick: () => assignMealToDay(day, meal),
                                    //             className: "text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200 transition-colors",
                                    //             title: `Add to ${day}`
                                    //         }, day.slice(0, 3))
                                    //     )
                                    // )
                                )
                            )
                        ),

                        meals.length === 0 && React.createElement('div', { className: "text-center py-12 text-gray-500" },
                            React.createElement('p', {}, "No meals in your library yet."),
                            React.createElement('p', {}, "Click \"Add New Meal\" to get started!")
                        )
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(MealPlannerApp), document.getElementById('root'));
    </script>
</body>
</html>
